/*
 * jquery.flot.tooltip
 * 
 * description: easy-to-use tooltips for Flot charts
 * version: 0.8.5
 * authors: Krzysztof Urbas @krzysu [myviews.pl],Evan Steinkerchner @Roundaround
 * website: https://github.com/krzysu/flot.tooltip
 * 
 * build on 2015-06-12
 * released under MIT License, 2012
*/ 
!function($){var t={tooltip:{show:!1,cssClass:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,snap:!0,lines:!1,onHover:function(t,e){},$compat:!1}};t.tooltipOpts=t.tooltip;var e=function(t){this.tipPosition={x:0,y:0},this.init(t)};e.prototype.init=function(t){function e(e){var i={};i.x=e.pageX,i.y=e.pageY,t.setTooltipPosition(i)}function i(e,i,s){var n=function(t,e,i,o){return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e))},a=function(t,e,i,o,s,a,p){if(!p||(p=function(t,e,i,o,s,n){if("undefined"!=typeof i)return{x:i,y:e};if("undefined"!=typeof o)return{x:t,y:o};var a,p=-1/((n-o)/(s-i));return{x:a=(s*(t*p-e+o)+i*(t*-p+e-n))/(p*(s-i)+o-n),y:p*a-p*t+e}}(t,e,i,o,s,a),p.x>=Math.min(i,s)&&p.x<=Math.max(i,s)&&p.y>=Math.min(o,a)&&p.y<=Math.max(o,a))){var r=o-a,l=s-i,d=i*a-o*s;return Math.abs(r*t+l*e+d)/Math.sqrt(r*r+l*l)}var x=n(t,e,i,o),c=n(t,e,s,a);return x>c?c:x};if(s)t.showTooltip(s,o.tooltipOptions.snap?s:i);else if(o.plotOptions.series.lines.show&&o.tooltipOptions.lines===!0){var p=o.plotOptions.grid.mouseActiveRadius,r={distance:p+1},l=i;$.each(t.getData(),function(e,s){for(var p=0,d=-1,x=1;x<s.data.length;x++)s.data[x-1][0]<=i.x&&s.data[x][0]>=i.x&&(p=x-1,d=x);if(-1===d)return void t.hideTooltip();var c={x:s.data[p][0],y:s.data[p][1]},f={x:s.data[d][0],y:s.data[d][1]},u=a(s.xaxis.p2c(i.x),s.yaxis.p2c(i.y),s.xaxis.p2c(c.x),s.yaxis.p2c(c.y),s.xaxis.p2c(f.x),s.yaxis.p2c(f.y),!1);if(u<r.distance){var y=n(c.x,c.y,i.x,i.y)<n(i.x,i.y,f.x,f.y)?p:d,h=s.datapoints.pointsize,m=[i.x,c.y+(f.y-c.y)*((i.x-c.x)/(f.x-c.x))],v={datapoint:m,dataIndex:y,series:s,seriesIndex:e};r={distance:u,item:v},o.tooltipOptions.snap&&(l={pageX:s.xaxis.p2c(m[0]),pageY:s.yaxis.p2c(m[1])})}}),r.distance<p+1?t.showTooltip(r.item,l):t.hideTooltip()}else t.hideTooltip()}var o=this,s=$.plot.plugins.length;if(this.plotPlugins=[],s)for(var n=0;s>n;n++)this.plotPlugins.push($.plot.plugins[n].name);t.hooks.bindEvents.push(function(t,s){if(o.plotOptions=t.getOptions(),"boolean"==typeof o.plotOptions.tooltip&&(o.plotOptions.tooltipOpts.show=o.plotOptions.tooltip,o.plotOptions.tooltip=o.plotOptions.tooltipOpts,delete o.plotOptions.tooltipOpts),o.plotOptions.tooltip.show!==!1&&"undefined"!=typeof o.plotOptions.tooltip.show){o.tooltipOptions=o.plotOptions.tooltip,o.tooltipOptions.$compat?(o.wfunc="width",o.hfunc="height"):(o.wfunc="innerWidth",o.hfunc="innerHeight");var n=o.getDomElement();$(t.getPlaceholder()).bind("plothover",i),$(s).bind("mousemove",e)}}),t.hooks.shutdown.push(function(t,o){$(t.getPlaceholder()).unbind("plothover",i),$(o).unbind("mousemove",e)}),t.setTooltipPosition=function(t){var e=o.getDomElement(),i=e.outerWidth()+o.tooltipOptions.shifts.x,s=e.outerHeight()+o.tooltipOptions.shifts.y;t.x-$(window).scrollLeft()>$(window)[o.wfunc]()-i&&(t.x-=i),t.y-$(window).scrollTop()>$(window)[o.hfunc]()-s&&(t.y-=s),isNaN(t.x)?o.tipPosition.x=o.tipPosition.xPrev:(o.tipPosition.x=t.x,o.tipPosition.xPrev=t.x),isNaN(t.y)?o.tipPosition.y=o.tipPosition.yPrev:(o.tipPosition.y=t.y,o.tipPosition.yPrev=t.y)},t.showTooltip=function(e,i,s){var n=o.getDomElement(),a=o.stringFormat(o.tooltipOptions.content,e);""!==a&&(n.html(a),t.setTooltipPosition({x:i.pageX,y:i.pageY}),n.css({left:o.tipPosition.x+o.tooltipOptions.shifts.x,top:o.tipPosition.y+o.tooltipOptions.shifts.y}).show(),"function"==typeof o.tooltipOptions.onHover&&o.tooltipOptions.onHover(e,n))},t.hideTooltip=function(){o.getDomElement().hide().html("")}},e.prototype.getDomElement=function(){var t=$("."+this.tooltipOptions.cssClass);return 0===t.length&&(t=$("<div />").addClass(this.tooltipOptions.cssClass),t.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&t.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})),t},e.prototype.stringFormat=function(t,e){var i=/%p\.{0,1}(\d{0,})/,o=/%s/,s=/%c/,n=/%lx/,a=/%ly/,p=/%x\.{0,1}(\d{0,})/,r=/%y\.{0,1}(\d{0,})/,l="%x",d="%y",x="%ct",c="%n",f,u,y,h,m;if("undefined"!=typeof e.series.threshold?(f=e.datapoint[0],u=e.datapoint[1],y=e.datapoint[2]):"undefined"!=typeof e.series.curvedLines?(f=e.datapoint[0],u=e.datapoint[1]):"undefined"!=typeof e.series.lines&&e.series.lines.steps?(f=e.series.datapoints.points[2*e.dataIndex],u=e.series.datapoints.points[2*e.dataIndex+1],y=""):(f=e.series.data[e.dataIndex][0],u=e.series.data[e.dataIndex][1],y=e.series.data[e.dataIndex][2]),null===e.series.label&&e.series.originSeries&&(e.series.label=e.series.originSeries.label),"function"==typeof t&&(t=t(e.series.label,f,u,e)),"boolean"==typeof t&&!t)return"";if(y&&(t=t.replace(x,y)),"undefined"!=typeof e.series.percent?h=e.series.percent:"undefined"!=typeof e.series.percents&&(h=e.series.percents[e.dataIndex]),"number"==typeof h&&(t=this.adjustValPrecision(i,t,h)),e.series.hasOwnProperty("pie")&&(0||(m=e.series.data[0][1])),"number"==typeof m&&(t=t.replace(c,m)),t="undefined"!=typeof e.series.label?t.replace(o,e.series.label):t.replace(o,""),t="undefined"!=typeof e.series.color?t.replace(s,e.series.color):t.replace(s,""),t=this.hasAxisLabel("xaxis",e)?t.replace(n,e.series.xaxis.options.axisLabel):t.replace(n,""),t=this.hasAxisLabel("yaxis",e)?t.replace(a,e.series.yaxis.options.axisLabel):t.replace(a,""),this.isTimeMode("xaxis",e)&&this.isXDateFormat(e)&&(t=t.replace(p,this.timestampToDate(f,this.tooltipOptions.xDateFormat,e.series.xaxis.options))),this.isTimeMode("yaxis",e)&&this.isYDateFormat(e)&&(t=t.replace(r,this.timestampToDate(u,this.tooltipOptions.yDateFormat,e.series.yaxis.options))),"number"==typeof f&&(t=this.adjustValPrecision(p,t,f)),"number"==typeof u&&(t=this.adjustValPrecision(r,t,u)),"undefined"!=typeof e.series.xaxis.ticks){var v;v=this.hasRotatedXAxisTicks(e)?"rotatedTicks":"ticks";var g=e.dataIndex+e.seriesIndex;for(var O in e.series.xaxis[v])if(e.series.xaxis[v].hasOwnProperty(g)&&!this.isTimeMode("xaxis",e)){var b=this.isCategoriesMode("xaxis",e)?e.series.xaxis[v][g].label:e.series.xaxis[v][g].v;b===f&&(t=t.replace(p,e.series.xaxis[v][g].label))}}if("undefined"!=typeof e.series.yaxis.ticks)for(var P in e.series.yaxis.ticks)if(e.series.yaxis.ticks.hasOwnProperty(P)){var w=this.isCategoriesMode("yaxis",e)?e.series.yaxis.ticks[P].label:e.series.yaxis.ticks[P].v;w===u&&(t=t.replace(r,e.series.yaxis.ticks[P].label))}return"undefined"!=typeof e.series.xaxis.tickFormatter&&(t=t.replace(l,e.series.xaxis.tickFormatter(f,e.series.xaxis).replace(/\$/g,"$$"))),"undefined"!=typeof e.series.yaxis.tickFormatter&&(t=t.replace(d,e.series.yaxis.tickFormatter(u,e.series.yaxis).replace(/\$/g,"$$"))),t},e.prototype.isTimeMode=function(t,e){return"undefined"!=typeof e.series[t].options.mode&&"time"===e.series[t].options.mode},e.prototype.isXDateFormat=function(t){return"undefined"!=typeof this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat},e.prototype.isYDateFormat=function(t){return"undefined"!=typeof this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat},e.prototype.isCategoriesMode=function(t,e){return"undefined"!=typeof e.series[t].options.mode&&"categories"===e.series[t].options.mode},e.prototype.timestampToDate=function(t,e,i){var o=$.plot.dateGenerator(t,i);return $.plot.formatDate(o,e,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},e.prototype.adjustValPrecision=function(t,e,i){var o,s=e.match(t);return null!==s&&""!==RegExp.$1&&(o=RegExp.$1,i=i.toFixed(o),e=e.replace(t,i)),e},e.prototype.hasAxisLabel=function(t,e){return-1!==$.inArray(this.plotPlugins,"axisLabels")&&"undefined"!=typeof e.series[t].options.axisLabel&&e.series[t].options.axisLabel.length>0},e.prototype.hasRotatedXAxisTicks=function(t){return-1!==$.inArray(this.plotPlugins,"tickRotor")&&"undefined"!=typeof t.series.xaxis.rotatedTicks};var i=function(t){new e(t)};$.plot.plugins.push({init:i,options:t,name:"tooltip",version:"0.8.5"})}(jQuery);